{
  "task": "Polish Savings Report PDF styling to fully match DMP brand and premium hierarchy (DocRaptor-safe).",
  "context": {
    "reference_pdf": "Latest Savings Report rendering (v34).",
    "notes": [
      "Palette application is partial; unify usage across titles, rules, section headers, highlights.",
      "Key metrics should stand out more (Monthly/Annual Savings).",
      "Footer text wraps awkwardly."
    ]
  },
  "requirements": [
    "Keep one <style> block, no external CSS.",
    "Use tables/blocks only (no complex flex/grid for critical layout).",
    "Keep Base64 logo via ${LOGO_DATA_URL}.",
    "Apply DMP palette: Ultramarine (#004ED3) primary, Aqua (#2BD8C2) accent, Spruce (#00937B) positive emphasis, Ink (#0B2340) for headings."
  ],
  "implementation": {
    "style_block_replace": {
      "description": "Replace existing style block with this (or merge carefully).",
      "code": "<style>\n  :root{\n    --brand-ultramarine:#004ED3; /* primary */\n    --brand-aqua:#2BD8C2;        /* accent */\n    --brand-spruce:#00937B;      /* positive emphasis */\n    --brand-ink:#0B2340;         /* headings */\n    --ink-800:#1F2937;           /* body text */\n    --muted:#6B7280;             /* secondary text */\n    --border:#E5E7EB;            /* table borders */\n    --bg-soft:#F9FAFB;           /* section header bg */\n  }\n  html,body{ margin:0; padding:0; }\n  body{ font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink-800); font-size:12px; }\n  .container{ padding:24px; }\n  .header{ width:100%; border-collapse:collapse; margin-bottom:10px; }\n  .brand-cell{ width:180px; vertical-align:middle; }\n  .title{ font-weight:800; font-size:20px; line-height:1.2; color:var(--brand-ink); }\n  .subtitle{ color:var(--muted); font-size:12px; }\n  .rule{ height:3px; background:var(--brand-ultramarine); border-radius:2px; margin:10px 0 16px; }\n\n  .section{ margin-top:14px; border:1px solid var(--border); border-radius:8px; overflow:hidden; }\n  .section-hd{ background:var(--bg-soft); padding:9px 12px; border-bottom:1px solid var(--border); position:relative; }\n  .section-hd:before{ content:\"\"; position:absolute; left:0; top:0; bottom:0; width:4px; background:var(--brand-ultramarine); }\n  .section-title{ font-weight:700; color:var(--brand-ink); padding-left:2px; }\n  .section-bd{ padding:12px; }\n\n  .kv{ width:100%; border-collapse:collapse; }\n  .kv th,.kv td{ text-align:left; padding:8px 6px; border-bottom:1px solid var(--border); vertical-align:top; }\n  .kv th{ color:var(--muted); font-weight:600; width:42%; }\n  .kv tr:last-child th,.kv tr:last-child td{ border-bottom:none; }\n\n  .cards{ display:block; }\n  .card{ border:1px solid var(--border); border-radius:8px; padding:10px 12px; margin-top:10px; }\n  .highlight{ background:linear-gradient(90deg, rgba(43,216,194,0.18), rgba(43,216,194,0)); border:1px solid var(--brand-aqua); }\n  .metric{ font-weight:800; font-size:14px; color:var(--ink-800); }\n  .metric-lg{ font-weight:900; font-size:16px; }\n  .metric-pos{ color:var(--brand-spruce); }\n\n  .footer{ margin-top:22px; padding-top:10px; border-top:1px solid var(--border); font-size:10px; color:var(--muted); display:flex; justify-content:space-between; gap:8px; }\n  .footer-left{ white-space:nowrap; }\n  .footer-right{ white-space:nowrap; }\n</style>"
    },
    "header_block_update": {
      "description": "Keep as-is; ensure rule is Ultramarine.",
      "code": "<table class=\"header\">\n  <tr>\n    <td class=\"brand-cell\"><img src=\"${LOGO_DATA_URL}\" alt=\"DMP Logo\" style=\"width:140px;height:auto;display:block;\" /></td>\n    <td>\n      <div class=\"title\">Dual Pricing Savings Report</div>\n      <div class=\"subtitle\">Dynamic Merchant Processing</div>\n    </td>\n    <td style=\"text-align:right;\">\n      <div class=\"subtitle\">Report #: {{reportId}}</div>\n      <div class=\"subtitle\">Date: {{reportDate}}</div>\n    </td>\n  </tr>\n</table>\n<div class=\"rule\"></div>"
    },
    "sections_update": {
      "savings_cards": {
        "description": "Make Monthly Savings pop with Spruce and larger type.",
        "code": "<div class=\"cards\">\n  <div class=\"card\">\n    <div style=\"font-weight:700;\">Current Processing Cost</div>\n    <div class=\"metric\">{{currentProcessingCostFormatted}}</div>\n  </div>\n  <div class=\"card\">\n    <div style=\"font-weight:700;\">New Processing Cost</div>\n    <div class=\"metric\">{{newProcessingCostFormatted}}</div>\n  </div>\n  <div class=\"card highlight\">\n    <div style=\"font-weight:700;\">Monthly Savings</div>\n    <div class=\"metric metric-lg metric-pos\">{{monthlySavingsFormatted}} / mo</div>\n  </div>\n</div>"
      },
      "annual_section": {
        "description": "Keep emphasis on Annual Savings in Spruce.",
        "code": "<div class=\"section\">\n  <div class=\"section-hd\"><div class=\"section-title\">Annual Impact</div></div>\n  <div class=\"section-bd\">\n    <table class=\"kv\">\n      <tr><th>Annual Savings</th><td class=\"metric metric-lg metric-pos\">{{annualSavingsFormatted}}</td></tr>\n      <tr><th>Processing Volume</th><td>{{annualVolumeFormatted}}</td></tr>\n    </table>\n  </div>\n</div>"
      }
    },
    "footer_fix": {
      "description": "Prevent mid-line wrap; shorten copy if needed.",
      "code": "<div class=\"footer\">\n  <div class=\"footer-left\">Dynamic Merchant Processing • info@dmprocessing.com • (555) 123-4567</div>\n  <div class=\"footer-right\">Page <span class=\"pageNumber\"></span> of <span class=\"totalPages\"></span></div>\n</div>"
    }
  },
  "acceptance_criteria": [
    "Ultramarine (#004ED3) used for rule and section header side bar.",
    "Headings in Ink (#0B2340); body text neutral; rows have lighter borders.",
    "Monthly Savings card uses Aqua highlight background and Spruce text for the value, with larger type.",
    "Footer no longer breaks the phone number; both footer items remain on one line.",
    "Overall look matches first app’s premium feel while maintaining DocRaptor compatibility."
  ]
}
