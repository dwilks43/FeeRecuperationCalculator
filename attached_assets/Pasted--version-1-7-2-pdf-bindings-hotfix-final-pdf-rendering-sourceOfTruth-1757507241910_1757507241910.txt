{
  "version": "1.7.2-pdf-bindings-hotfix-final",
  "pdf": {
    "rendering": {
      "sourceOfTruth": "ui_and_results",
      "noNewMath": true,
      "bindStrategy": "byKey",
      "interpolateStrings": true,
      "fallbackNullToEmpty": true
    },
    "theme": {
      "colors": {
        "brandUltramarine": "#0046FF",
        "brandAqua": "#1CD3D3",
        "brandSpruce": "#0A7A64",
        "brandInk": "#0F172A",
        "mutedInk": "#334155",
        "border": "#E5E7EB",
        "panel": "#FFFFFF",
        "subtle": "#F8FAFC",
        "danger": "#DC2626",
        "success": "#059669",
        "info": "#2563EB"
      },
      "typography": {
        "fontFamily": "Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif",
        "h1": { "size": 18, "weight": 700, "color": "brandInk" },
        "h2": { "size": 14, "weight": 700, "color": "brandInk" },
        "h3": { "size": 12, "weight": 700, "color": "brandInk" },
        "label": { "size": 10, "weight": 600, "color": "brandInk" },
        "value": { "size": 10, "weight": 600, "color": "brandInk" },
        "fine": { "size": 9, "weight": 400, "color": "mutedInk" }
      },
      "layout": {
        "pageWidthIn": 8.5,
        "pageHeightIn": 11,
        "marginIn": 0.5,
        "gridGap": 12,
        "blockY": 12,
        "rowY": 8,
        "colGap": 14,
        "cardPadding": 12
      },
      "borders": {
        "radius": 10,
        "hairline": "1px solid #E5E7EB"
      },
      "badges": {
        "auto": { "bg": "#E8F1FF", "fg": "#0046FF" },
        "manual": { "bg": "#FFF7ED", "fg": "#C2410C" },
        "internal": { "bg": "#EEF2FF", "fg": "#3730A3" }
      },
      "kpiColors": {
        "cost": "danger",
        "feesCollected": "success",
        "bases": "info",
        "net": "brandSpruce"
      }
    },
    "formatting": {
      "currency": { "decimals": 2, "thousands": true, "style": "leadingMinus", "symbol": "$", "align": "right" },
      "percent": { "decimals": 2, "suffix": "%", "thousands": false, "style": "leadingMinus", "align": "right" },
      "normalizePercent": { "mode": "auto", "thresholdGtOneTreatAsPercent": true },
      "coercePercentStrings": true,
      "tabularNumbers": true
    },
    "labels": {
      "summaryTitle": "DMP Savings Report",
      "programInputs": "Program & Inputs",
      "kpiTitle": "Monthly Processing Savings",
      "derivedTitle": "Derived Bases & Totals",
      "processingTitle": "Processing on Cards (New Program)",
      "savingsTitle": "Savings vs Today",
      "profitTitle": "Gross Profit",
      "internalBadge": "Internal",
      "footerLeft": "Dynamic Merchant Processing",
      "footerRight": "© DMP — Confidential",
      "titleCase": true
    },
    "dataBindings": {
      "meta": {
        "reportId": ["report.id", "results.reportId", "ui.report.id"],
        "reportDate": ["report.createdAtISO", "results.createdAtISO", "ui.report.date"]
      },
      "inputs": {
        "programTypeLabel": ["ui.program.label", "results.programTypeLabel", "results.programType", "program"],
        "monthlyCardVolume": ["inputs.monthlyVolume", "ui.inputs.monthlyVolume", "results.monthlyVolume"],
        "monthlyCashVolume": ["inputs.monthlyCashVolume", "ui.inputs.monthlyCashVolume", "results.monthlyCashVolume"],
        "currentRateDisplay": ["ui.inputs.currentRateDisplay", "results.currentRateDisplay", "inputs.currentRate"],
        "interchangeDisplay": ["ui.inputs.interchangeDisplay", "results.interchangeDisplay", "inputs.interchangeCost"],
        "taxRateDisplay": ["ui.inputs.taxRateDisplay", "results.taxRateDisplay", "inputs.taxRate"],
        "tipRateDisplay": ["ui.inputs.tipRateDisplay", "results.tipRateDisplay", "inputs.tipRate"],
        "priceDiffDisplay": ["ui.inputs.priceDifferentialDisplay", "results.priceDifferentialDisplay", "inputs.priceDifferential"],
        "supplementalFeeDisplay": ["ui.inputs.supplementalFeeDisplay", "results.supplementalFeeDisplay", "inputs.supplementalFee"],
        "feeTimingLabel": ["ui.inputs.feeTimingLabel", "results.feeTimingLabel"],
        "feeTaxBasisLabel": ["ui.inputs.feeTaxBasisLabel", "results.feeTaxBasisLabel"]
      },
      "ui": {
        "flatRatePercentDisplay": ["ui.flatRatePercentDisplay", "results.flatRatePercentDisplay", "inputs.flatRate"],
        "monthlySavings.items": ["ui.monthlySavings.items", "results.monthlySavings.items"],
        "orderOfOperationsText": ["ui.orderOfOperationsText", "results.orderOfOperationsText", "ui.orderOfOpsText"]
      },
      "sections": {
        "derived": ["details.derivedBases", "ui.details.derivedBases", "results.details.derivedBases"],
        "processing": ["details.processingOnCards", "ui.details.processingOnCards", "results.details.processingOnCards"],
        "savingsVsToday": ["details.savingsVsToday", "ui.details.savingsVsToday", "results.details.savingsVsToday"],
        "profit": ["details.grossProfitInternal", "ui.details.grossProfitInternal", "results.details.grossProfitInternal"]
      },
      "state": {
        "program": ["ui.program.code", "results.programCode", "program"],
        "isFlatRateManual": ["ui.state.isFlatRateManual", "results.state.isFlatRateManual", "state.isFlatRateManual"]
      }
    },
    "pages": [
      {
        "name": "Summary",
        "header": {
          "title": "DMP Savings Report",
          "left": "Report # {{ meta.reportId }}",
          "right": "{{ meta.reportDate }}",
          "showOnPage": 1
        },
        "layout": {
          "columns": 12,
          "gap": 12
        },
        "body": [
          {
            "type": "card",
            "colSpan": 7,
            "surface": "panel",
            "title": "Program & Inputs",
            "content": {
              "rows": [
                { "label": "Program Type", "value": "inputs.programTypeLabel" },
                { "label": "Monthly Card Volume", "value": "inputs.monthlyCardVolume", "format": "currency" },
                { "label": "Monthly Cash Volume", "value": "inputs.monthlyCashVolume", "format": "currency", "if": "inputs.monthlyCashVolume != null" },
                { "label": "Current Processing Rate", "value": "inputs.currentRateDisplay", "format": "percent" },
                { "label": "Interchange Cost", "value": "inputs.interchangeDisplay", "format": "percent" },
                { "label": "Tax Rate", "value": "inputs.taxRateDisplay", "format": "percent" },
                { "label": "Tip Rate", "value": "inputs.tipRateDisplay", "format": "percent" },
                { "if": "state.program == 'DUAL_PRICING'", "label": "Price Differential", "value": "inputs.priceDiffDisplay", "format": "percent" },
                { "if": "state.program == 'SUPPLEMENTAL_FEE'", "label": "Supplemental Fee", "value": "inputs.supplementalFeeDisplay", "format": "percent" },
                { "if": "state.program == 'SUPPLEMENTAL_FEE'", "label": "Fee Timing", "value": "inputs.feeTimingLabel" },
                { "if": "state.program == 'SUPPLEMENTAL_FEE'", "label": "Fee Tax Basis", "value": "inputs.feeTaxBasisLabel" },
                {
                  "label": "Flat Rate % (Bank Mapping)",
                  "value": "ui.flatRatePercentDisplay",
                  "format": "percent",
                  "badge": { "text": "Auto", "when": "!state.isFlatRateManual", "style": "auto" },
                  "badgeAlt": { "text": "Manual", "when": "state.isFlatRateManual", "style": "manual" }
                }
              ]
            },
            "footerNote": "Values mirror the on-screen display—no recalculation."
          },
          {
            "type": "card",
            "colSpan": 5,
            "surface": "panel",
            "title": "Monthly Processing Savings",
            "kpiRailFrom": "ui.monthlySavings.items",
            "kpi": {
              "labelKey": "label",
              "valueKey": "value",
              "valueFormat": "currency",
              "stripZero": false
            }
          }
        ],
        "footer": {
          "left": "Dynamic Merchant Processing",
          "right": "© DMP — Confidential",
          "divider": true
        }
      },
      {
        "name": "Details",
        "header": {
          "title": "",
          "left": "",
          "right": "",
          "showOnPage": 0
        },
        "layout": {
          "columns": 12,
          "gap": 12
        },
        "body": [
          {
            "type": "section",
            "title": "Derived Bases & Totals",
            "note": "{{ ui.orderOfOperationsText }}",
            "table": {
              "cols": [
                { "key": "label", "title": "Label", "style": "label", "align": "left" },
                { "key": "value", "title": "Amount", "style": "value", "align": "right" }
              ],
              "rowsFrom": [
                { "from": "sections.derived" }
              ],
              "valueFormatHintKey": "format"
            },
            "surface": "subtle"
          },
          {
            "type": "section",
            "title": "Processing on Cards (New Program)",
            "fine": "Coverage % shows how much the price differential/fee offsets the processor charge.",
            "table": {
              "cols": [
                { "key": "label", "title": "Label", "style": "label", "align": "left" },
                { "key": "value", "title": "Amount", "style": "value", "align": "right" }
              ],
              "rowsFrom": [
                { "from": "sections.processing" }
              ],
              "valueFormatHintKey": "format"
            },
            "surface": "subtle"
          },
          {
            "type": "section",
            "title": "Savings vs Today",
            "table": {
              "cols": [
                { "key": "label", "title": "Label", "style": "label", "align": "left" },
                { "key": "value", "title": "Amount", "style": "value", "align": "right" }
              ],
              "rowsFrom": [
                { "from": "sections.savingsVsToday" }
              ],
              "valueFormatHintKey": "format"
            },
            "surface": "subtle"
          },
          {
            "type": "section",
            "title": "Gross Profit",
            "badge": { "text": "Internal", "style": "internal" },
            "table": {
              "cols": [
                { "key": "label", "title": "Label", "style": "label", "align": "left" },
                { "key": "value", "title": "Amount", "style": "value", "align": "right" }
              ],
              "rowsFrom": [
                { "from": "sections.profit" }
              ],
              "valueFormatHintKey": "format"
            },
            "surface": "subtle"
          }
        ],
        "footer": {
          "left": "Dynamic Merchant Processing",
          "right": "© DMP — Confidential",
          "divider": true
        }
      }
    ]
  },
  "guards": {
    "hideEmptyRows": true,
    "stripZeroKPIs": false,
    "coercePercentStrings": true
  }
}
